local Args = {...}
local ModemSide = nil

shell.run("clear")
if #Args == 0 then
    print("Syntax: pc (Channel1) (Channel2) (Channel3) (...)")
    return false
end

local function GetPeriSide(Peri)
    if peripheral.getType("left") == Peri then
        return "left"
    elseif peripheral.getType("right") == Peri then
        return "right"
    elseif peripheral.getType("top") == Peri then
        return "top"
    elseif peripheral.getType("bottom") == Peri then
        return "bottom"
    else
        return nil
    end
end

ModemSide = GetPeriSide("modem")
if ModemSide == nil then
    print("Error: This program requires a modem. Please install on onto your computer")
    return false
end

local TermSide = GetPeriSide("monitor")
if TermSide ~= nil then
    local Term = peripheral.wrap(TermSide)
    term.redirect(Term)
    term.clear()
    term.setCursorPos(1,1)
end

rednet.open(ModemSide)

local ChannelStr = "Listening on these channels: "

for J = 1, #Args do
    ChannelStr = ChannelStr .. Args[J] .. ", "
end

ChannelStr = string.sub(ChannelStr, 0, #ChannelStr - 2)
term.setBackgroundColor(colors.black)
term.setTextColor(colors.lime)
print(ChannelStr)

while true do
    local ID, Msg, Dist = rednet.receive()
    
    local I = string.find(Msg,"|")
    
    if I ~= nil then
        local Channel = string.sub(Msg,0,I - 1)
        for J = 1, #Args do
            if Args[J] == Channel then
                term.setTextColor(colors.cyan)
                print(string.sub(Msg, I + 1))
                break
            end
        end
    end
end
